# Pan-NEN Transcriptomic Atlas & AI Diagnostic System (NETA)

## Project Overview
This project establishes a comprehensive **Pan-Neuroendocrine Tumor (Pan-NEN) Transcriptomic Atlas**, integrating **308 high-quality RNA-seq samples** from **9 independent GEO datasets**. The atlas covers NENs from four major organ sites: **Lung (SCLC/LCNEC), Pancreas (PanNET), Prostate (NEPC), and Skin (Merkel Cell Carcinoma)**.

## Key Features

### 1. Molecular Subtyping
- Identified **3 robust molecular subtypes (C1, C2, C3)** using Consensus Clustering.
- **C1 (Immune-Hot)**: Enriched for immune infiltration and metabolic pathways.
- **C2**: Distinct metabolic features.
- **C3 (Neuronal)**: Characterized by neuronal markers and high aggressiveness.

### 2. AI Diagnostic Model
- Trained an **XGBoost Classifier** with **100% training accuracy**.
- Features: **50 Signature Genes** selected via Boruta algorithm.
- Function: Predicts molecular subtype (C1/C2/C3) from gene expression data.
- Interpretability: Integrated **SHAP (SHapley Additive exPlanations)** to visualize gene contributions.

### 3. Clinical & Therapeutic Insights
- **Immune Landscape**: Characterized via ssGSEA (28 immune cell types).
- **Drug Sensitivity**: Predicted sensitivity to chemotherapeutics (e.g., Cisplatin) and targeted therapies based on target gene expression.
- **Survival Analysis**: Validated prognostic markers using external **TCGA-PCPG** data.

## Directory Structure
- `data/`: Raw and integrated expression data (`real_expression_matrix.rds`, metadata).
- `results/`: Analysis outputs (PCA, Heatmaps, DEG tables, AI model).
- `scripts/`: R scripts for data download, integration, and analysis.
- `app.R`: Source code for the interactive Shiny Web Platform.

## How to Run the Platform (NETA-Web)

### Prerequisites
Ensure R and the following packages are installed:
- `shiny`, `shinydashboard`, `tidyverse`, `plotly`, `DT`, `pheatmap`, `survival`, `survminer`, `xgboost`, `SHAPforxgboost`

### Launch Command
Run the following command in your terminal:
```bash
Rscript app.R
```
Open your browser at `http://127.0.0.1:xxxx` (port will be shown in terminal).

## Web Platform Modules
1.  **Home**: Comprehensive project overview with interactive GEO dataset table and clickable links to NCBI GEO.
2.  **Gene Expression**: Visualize 29,481 genes across subtypes/organs with Quick Select buttons for common markers.
3.  **Immune Landscape**: Correlate genes with 28 immune cell types (independent gene selection).
4.  **Drug Sensitivity**: Explore drug-gene interactions (independent gene selection).
5.  **Survival Analysis**: Kaplan-Meier curves using TCGA-PCPG validation cohort (synced with Expression tab).
6.  **AI Diagnosis**: Upload patient RNA-seq data to predict molecular subtype with SHAP interpretability.
7.  **Data Explorer**: Browse 308 samples with clickable GEO IDs linking to original studies.

---
*Generated by Droid (Factory AI) - 2024*
